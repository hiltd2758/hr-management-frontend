<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" />
    <meta name="description" content="Smarthr - Bootstrap Admin Template" />
    <meta
      name="keywords"
      content="admin, estimates, bootstrap, business, corporate, creative, management, minimal, modern, accounts, invoice, html5, responsive, CRM, Projects"
    />
    <meta name="author" content="Dreamguys - Bootstrap Admin Template" />
    <meta name="robots" content="noindex, nofollow" />
    <title>Attendance - HRMS admin template</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel="stylesheet" />

    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.png" />
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/font-awesome.min.css" />
    <link rel="stylesheet" href="assets/css/line-awesome.min.css" />
    <link rel="stylesheet" href="assets/css/select2.min.css" />
    <link rel="stylesheet" href="assets/css/dataTables.bootstrap4.min.css" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <style>
      /* locked day style: visually indicate saved (not editable) */
      .calendar .day.locked {
        opacity: 0.85;
        pointer-events: none;
      }
      /* make layout full-height and allow calendar to flex */
      html,
      body {
        height: 100%;
      }
      .main-wrapper {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .page-wrapper {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
      }
      .content.container-fluid {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        min-height: 0;
        padding-bottom: 24px;
      }

      /* calendar should expand to fill remaining space */
      .calendar {
        display: flex;
        flex-direction: column;
        border: 1px solid #e6e6e6;
        border-radius: 6px;
        padding: 13px;
        background: #fff;
        flex: 1 1 auto;
        min-height: 0;
        font-size: 0.86rem;
      }
      /* table area grows and scrolls if overflow */
      .calendar .table-responsive {
        flex: 1 1 auto;
        min-height: 0;
        overflow: auto;
      }
      .calendar table {
        table-layout: fixed;
        width: 100%;
        height: 100%;
      }
      /* let cells size naturally (fill height by content) */
      .calendar table td {
        vertical-align: top;
        height: auto;
      }
      @media (max-width: 992px) {
        .calendar {
          padding: 10px;
        }
        .calendar table td {
          height: 61px; /* was 68px */
        }
        .calendar {
          min-height: auto;
        }
      }
      /* Small custom styles for calendar (enlarged) */
      /* day cell sizing adjusted down ~25% */
      .calendar .day {
        border: 1px solid transparent;
        padding: 8px; /* reduced further (~10% less) */
        min-height: 61px; /* reduced from 68px */
        cursor: pointer;
        position: relative;
      }
      .calendar .day.other-month {
        color: #c0c0c0;
        cursor: default;
      }
      /* disabled (non-clickable) day style */
      .calendar .day.disabled {
        cursor: default;
        opacity: 0.6;
        pointer-events: none;
      }
      .calendar .day.present {
        background: #e6ffed;
        border-color: #b7f0c7;
      }
      .calendar .day.absent {
        background: #fff1f0;
        border-color: #f0b7b7;
      }
      .calendar .date-num {
        font-weight: 600;
        display: block;
        font-size: 13px; /* slightly smaller */
      }
      .calendar .calendar-controls .btn {
        margin-left: 6px;
      }
      .legend span {
        display: inline-block;
        margin-right: 12px;
      }
      .stats-box {
        background: #fff;
        border: 1px solid #e6e6e6;
        padding: 12px;
        border-radius: 6px;
      }

      /* notification box area */
      #notifyContainer .alert {
        margin-bottom: 12px;
      }

      /* ensure calendar table fills width nicely */
      .calendar table th,
      .calendar table td {
        vertical-align: top;
        width: 14.2857%;
      }
    </style>
  </head>
  <body>
    <div class="main-wrapper">
      <div class="header">
        <div class="header-left">
          <a href="index.html" class="logo">
            <img src="assets/img/cmc_logo.png" width="60" height="60" alt="" />
          </a>
        </div>
        <a id="toggle_btn" href="javascript:void(0);">
          <span class="bar-icon">
            <span></span>
            <span></span>
            <span></span>
          </span>
        </a>
        <div class="page-title-box">
          <h3>CMC Global</h3>
        </div>
        <a id="mobile_btn" class="mobile_btn" href="#sidebar"><i class="fa fa-bars"></i></a>
        <ul class="nav user-menu">
          <li class="nav-item">
            <div class="top-nav-search">
              <a href="javascript:void(0);" class="responsive-search">
                <i class="fa fa-search"></i>
              </a>
              <form action="search.html">
                <input class="form-control" type="text" placeholder="Tìm kiếm" />
                <button class="btn" type="submit"><i class="fa fa-search"></i></button>
              </form>
            </div>
          </li>
          <li class="nav-item dropdown has-arrow flag-nav">
            <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button">
              <img src="assets/img/flags/vietnam.png" alt="" height="20" />
              <span>Tiếng Việt</span>
            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <a href="javascript:void(0);" class="dropdown-item">
                <img src="assets/img/flags/us.png" alt="" height="16" />
                English
              </a>
              <a href="javascript:void(0);" class="dropdown-item">
                <img src="assets/img/flags/vietnam.png" alt="" height="18" />
                Tiếng Việt
              </a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
              <i class="fa fa-bell-o"></i>
              <span class="badge badge-pill">3</span>
            </a>
            <div class="dropdown-menu notifications">
              <div class="topnav-dropdown-header">
                <span class="notification-title">Thông báo</span>
                <a href="javascript:void(0)" class="clear-noti">Xóa tất cả</a>
              </div>
              <div class="noti-content">
                <ul class="notification-list">
                  <li class="notification-message">
                    <a href="activities.html">
                      <div class="media">
                        <span class="avatar">
                          <img alt="" src="assets/img/profiles/default.jpg" />
                        </span>
                        <div class="media-body">
                          <p class="noti-details">
                            <span class="noti-title">Nguyễn Văn An</span>
                            đã thêm công việc mới
                            <span class="noti-title">Đặt lịch hẹn bệnh nhân</span>
                          </p>
                          <p class="noti-time"><span class="notification-time">4 phút trước</span></p>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="activities.html">
                      <div class="media">
                        <span class="avatar">
                          <img alt="" src="assets/img/profiles/default.jpg" />
                        </span>
                        <div class="media-body">
                          <p class="noti-details">
                            <span class="noti-title">Trần Minh Quân</span>
                            đã đổi tên công việc
                            <span class="noti-title">Đặt lịch hẹn kèm cổng thanh toán</span>
                          </p>
                          <p class="noti-time"><span class="notification-time">6 phút trước</span></p>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="activities.html">
                      <div class="media">
                        <span class="avatar">
                          <img alt="" src="assets/img/profiles/default.jpg" />
                        </span>
                        <div class="media-body">
                          <p class="noti-details">
                            <span class="noti-title">Lê Minh Tuấn</span>
                            đã thêm
                            <span class="noti-title">Domenic Houston</span>
                            và
                            <span class="noti-title">Claire Mapes</span>
                            vào dự án
                            <span class="noti-title">Mô-đun bác sĩ khả dụng</span>
                          </p>
                          <p class="noti-time"><span class="notification-time">8 phút trước</span></p>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="activities.html">
                      <div class="media">
                        <span class="avatar">
                          <img alt="" src="assets/img/profiles/default.jpg" />
                        </span>
                        <div class="media-body">
                          <p class="noti-details">
                            <span class="noti-title">Phạm Quốc Huy</span>
                            đã hoàn thành công việc
                            <span class="noti-title">Họp video giữa bệnh nhân và bác sĩ</span>
                          </p>
                          <p class="noti-time"><span class="notification-time">12 phút trước</span></p>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="activities.html">
                      <div class="media">
                        <span class="avatar">
                          <img alt="" src="assets/img/profiles/default.jpg" />
                        </span>
                        <div class="media-body">
                          <p class="noti-details">
                            <span class="noti-title">Đỗ Hoàng Anh</span>
                            đã thêm công việc mới
                            <span class="noti-title">Mô-đun chat riêng tư</span>
                          </p>
                          <p class="noti-time"><span class="notification-time">2 ngày trước</span></p>
                        </div>
                      </div>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="topnav-dropdown-footer">
                <a href="activities.html">Xem tất cả thông báo</a>
              </div>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
              <i class="fa fa-comment-o"></i>
              <span class="badge badge-pill">8</span>
            </a>
            <div class="dropdown-menu notifications">
              <div class="topnav-dropdown-header">
                <span class="notification-title">Tin nhắn</span>
                <a href="javascript:void(0)" class="clear-noti">Xóa tất cả</a>
              </div>
              <div class="noti-content">
                <ul class="notification-list">
                  <li class="notification-message">
                    <a href="chat.html">
                      <div class="list-item">
                        <div class="list-left">
                          <span class="avatar">
                            <img alt="" src="assets/img/profiles/default.jpg" />
                          </span>
                        </div>
                        <div class="list-body">
                          <span class="message-author">Nguyễn Văn Nam</span>
                          <span class="message-time">12:28 AM</span>
                          <div class="clearfix"></div>
                          <span class="message-content">Tin nhắn mẫu: nội dung văn bản thử nghiệm</span>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="chat.html">
                      <div class="list-item">
                        <div class="list-left">
                          <span class="avatar">
                            <img alt="" src="assets/img/profiles/default.jpg" />
                          </span>
                        </div>
                        <div class="list-body">
                          <span class="message-author">Trần Minh Quân</span>
                          <span class="message-time">6 Mar</span>
                          <div class="clearfix"></div>
                          <span class="message-content">Tin nhắn mẫu: nội dung văn bản thử nghiệm</span>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="chat.html">
                      <div class="list-item">
                        <div class="list-left">
                          <span class="avatar">
                            <img alt="" src="assets/img/profiles/default.jpg" />
                          </span>
                        </div>
                        <div class="list-body">
                          <span class="message-author">Đặng Thu Trang</span>
                          <span class="message-time">5 Mar</span>
                          <div class="clearfix"></div>
                          <span class="message-content">Tin nhắn mẫu: nội dung văn bản thử nghiệm</span>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="chat.html">
                      <div class="list-item">
                        <div class="list-left">
                          <span class="avatar">
                            <img alt="" src="assets/img/profiles/default.jpg" />
                          </span>
                        </div>
                        <div class="list-body">
                          <span class="message-author">Phạm Tuấn Anh</span>
                          <span class="message-time">3 Mar</span>
                          <div class="clearfix"></div>
                          <span class="message-content">Tin nhắn mẫu: nội dung văn bản thử nghiệm</span>
                        </div>
                      </div>
                    </a>
                  </li>
                  <li class="notification-message">
                    <a href="chat.html">
                      <div class="list-item">
                        <div class="list-left">
                          <span class="avatar">
                            <img alt="" src="assets/img/profiles/default.jpg" />
                          </span>
                        </div>
                        <div class="list-body">
                          <span class="message-author">Bùi Khánh Linh</span>
                          <span class="message-time">27 Feb</span>
                          <div class="clearfix"></div>
                          <span class="message-content">Tin nhắn mẫu: nội dung văn bản thử nghiệm</span>
                        </div>
                      </div>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="topnav-dropdown-footer">
                <a href="chat.html">Xem tất cả tin nhắn</a>
              </div>
            </div>
          </li>
          <li class="nav-item dropdown has-arrow main-drop">
            <a href="#" class="dropdown-toggle nav-link" data-toggle="dropdown">
              <span class="user-img">
                <img src="assets/img/user-circle-o.png" alt="" />
                <span class="status online"></span>
              </span>
              <span>Employee</span>
            </a>
            <div class="dropdown-menu">
              <a class="dropdown-item" href="profile.html">Hồ sơ của tôi</a>
              <a class="dropdown-item" href="settings.html">Cài đặt</a>
              <a class="dropdown-item" href="login.html">Đăng xuất</a>
            </div>
          </li>
        </ul>
        <div class="dropdown mobile-user-menu">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>
          <div class="dropdown-menu dropdown-menu-right">
            <a class="dropdown-item" href="profile.html">Hồ sơ của tôi</a>
            <a class="dropdown-item" href="settings.html">Cài đặt</a>
            <a class="dropdown-item" href="login.html">Đăng xuất</a>
          </div>
        </div>
      </div>
      <div class="sidebar" id="sidebar">
        <div class="sidebar-inner slimscroll">
          <div id="sidebar-menu" class="sidebar-menu">
            <ul>
              <li class="menu-title">
                <span>Main</span>
              </li>
              <li>
                <a class="active" href="index.html">
                  <i class="la la-dashboard"></i>
                  <span>Dashboard</span>
                </a>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-cube"></i>
                  <span>Apps</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="chat.html">Chat</a></li>

                  <li><a href="inbox.html">Email</a></li>
                </ul>
              </li>
              <li class="menu-title">
                <span>Employees</span>
              </li>
              <li class="submenu">
                <a href="#" class="noti-dot">
                  <i class="la la-user"></i>
                  <span>Employees</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="employees.html">All Employees</a></li>
                  <li>
                    <a href="leaves.html">
                      Leaves (Admin)
                      <span class="badge badge-pill bg-primary float-right">1</span>
                    </a>
                  </li>
                  <li><a href="leaves-employee.html">Leaves (Employee)</a></li>
                  <li><a href="leave-settings.html">Leave Settings</a></li>
                  <li><a href="attendance.html">Attendance (Admin)</a></li>
                  <li><a href="attendance-employee.html">Attendance (Employee)</a></li>
                  <li><a href="departments.html">Departments</a></li>
                  <li><a href="designations.html">Designations</a></li>
                  <li><a href="timesheet.html">Timesheet</a></li>
                  <li><a href="shift-scheduling.html">Shift & Schedule</a></li>
                  <li><a href="overtime.html">Overtime</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-rocket"></i>
                  <span>Tasks</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="tasks.html">Tasks</a></li>
                  <li><a href="task-board.html">Task Board</a></li>
                </ul>
              </li>
              <li>
                <a href="leads.html">
                  <i class="la la-user-secret"></i>
                  <span>Leads</span>
                </a>
              </li>
              <li>
                <a href="tickets.html">
                  <i class="la la-ticket"></i>
                  <span>Tickets</span>
                </a>
              </li>
              <li class="menu-title">
                <span>HR</span>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-files-o"></i>
                  <span>Sales</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="estimates.html">Estimates</a></li>
                  <li><a href="invoices.html">Invoices</a></li>
                  <li><a href="payments.html">Payments</a></li>
                  <li><a href="expenses.html">Expenses</a></li>
                  <li><a href="provident-fund.html">Provident Fund</a></li>
                  <li><a href="taxes.html">Taxes</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-files-o"></i>
                  <span>Accounting</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="categories.html">Categories</a></li>
                  <li><a href="budgets.html">Budgets</a></li>
                  <li><a href="budget-expenses.html">Budget Expenses</a></li>
                  <li><a href="budget-revenues.html">Budget Revenues</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-money"></i>
                  <span>Payroll</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="salary.html">Employee Salary</a></li>
                  <li><a href="salary-view.html">Payslip</a></li>
                  <li><a href="payroll-items.html">Payroll Items</a></li>
                </ul>
              </li>
              <li>
                <a href="policies.html">
                  <i class="la la-file-pdf-o"></i>
                  <span>Policies</span>
                </a>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-pie-chart"></i>
                  <span>Reports</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="expense-reports.html">Expense Report</a></li>
                  <li><a href="invoice-reports.html">Invoice Report</a></li>
                  <li><a href="payments-reports.html">Payments Report</a></li>
                  <li><a href="project-reports.html">Project Report</a></li>
                  <li><a href="task-reports.html">Task Report</a></li>
                  <li><a href="user-reports.html">User Report</a></li>
                  <li><a href="employee-reports.html">Employee Report</a></li>
                  <li><a href="payslip-reports.html">Payslip Report</a></li>
                  <li><a href="attendance-reports.html">Attendance Report</a></li>
                  <li><a href="leave-reports.html">Leave Report</a></li>
                  <li><a href="daily-reports.html">Daily Report</a></li>
                </ul>
              </li>
              <li class="menu-title">
                <span>Performance</span>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-graduation-cap"></i>
                  <span>Performance</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="performance-indicator.html">Performance Indicator</a></li>
                  <li><a href="performance.html">Performance Review</a></li>
                  <li><a href="performance-appraisal.html">Performance Appraisal</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-crosshairs"></i>
                  <span>Goals</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="goal-tracking.html">Goal List</a></li>
                  <li><a href="goal-type.html">Goal Type</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-edit"></i>
                  <span>Training</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="training.html">Training List</a></li>
                  <li><a href="trainers.html">Trainers</a></li>
                  <li><a href="training-type.html">Training Type</a></li>
                </ul>
              </li>
              <li>
                <a href="promotion.html">
                  <i class="la la-bullhorn"></i>
                  <span>Promotion</span>
                </a>
              </li>
              <li>
                <a href="resignation.html">
                  <i class="la la-external-link-square"></i>
                  <span>Resignation</span>
                </a>
              </li>
              <li>
                <a href="termination.html">
                  <i class="la la-times-circle"></i>
                  <span>Termination</span>
                </a>
              </li>
              <li class="menu-title">
                <span>Administration</span>
              </li>
              <li>
                <a href="assets.html">
                  <i class="la la-object-ungroup"></i>
                  <span>Assets</span>
                </a>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-briefcase"></i>
                  <span>Jobs</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="user-dashboard.html">User Dasboard</a></li>
                  <li><a href="jobs-dashboard.html">Jobs Dasboard</a></li>
                  <li><a href="jobs.html">Manage Jobs</a></li>
                  <li><a href="manage-resumes.html">Manage Resumes</a></li>
                  <li><a href="shortlist-candidates.html">Shortlist Candidates</a></li>
                  <li><a href="interview-questions.html">Interview Questions</a></li>
                  <li><a href="offer_approvals.html">Offer Approvals</a></li>
                  <li><a href="experiance-level.html">Experience Level</a></li>
                  <li><a href="candidates.html">Candidates List</a></li>
                  <li><a href="schedule-timing.html">Schedule timing</a></li>
                  <li><a href="apptitude-result.html">Aptitude Results</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-user"></i>
                  <span>Profile</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="profile.html">Employee Profile</a></li>
                  <li><a href="client-profile.html">Client Profile</a></li>
                </ul>
              </li>
              <li class="submenu">
                <a href="#">
                  <i class="la la-hand-o-up"></i>
                  <span>Subscriptions</span>
                  <span class="menu-arrow"></span>
                </a>
                <ul style="display: none">
                  <li><a href="subscriptions.html">Subscriptions (Admin)</a></li>
                  <li><a href="subscriptions-company.html">Subscriptions (Company)</a></li>
                  <li><a href="subscribed-companies.html">Subscribed Companies</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="page-wrapper">
        <div class="content container-fluid">
          <div class="row mb-3">
            <div class="col">
              <div class="page-header">
                <div class="row align-items-center">
                  <div class="col">
                    <h3 class="page-title">Chấm công nhân viên</h3>
                    <ul class="breadcrumb">
                      <li class="breadcrumb-item"><a href="index.html">Dashboard</a></li>
                      <li class="breadcrumb-item active">Attendance</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- New layout: left = selector + stats (narrow), right = calendar (wide) -->
          <div class="row">
            <!-- Left column: employee selector + statistics -->
            <div class="col-lg-3">
              <div class="card mb-3">
                <div class="card-body">
                  <h5 class="card-title mb-3">Chọn nhân viên</h5>
                  <div class="form-group">
                    <select id="employeeSelect" class="form-control form-control-sm select">
                      <!-- populated from EMPLOYEES template in JS -->
                    </select>
                  </div>

                  <hr />

                  <h6 class="mb-2">Thống kê tháng</h6>
                  <p id="monthLabel" class="text-muted small mb-1"></p>
                  <div class="mb-2">
                    <div class="d-flex justify-content-between small">
                      <span>Ngày đi làm</span>
                      <strong id="presentCount">0</strong>
                    </div>
                    <div class="d-flex justify-content-between small">
                      <span>Ngày vắng</span>
                      <strong id="absentCount">0</strong>
                    </div>
                    <div class="d-flex justify-content-between small">
                      <span>Ngày tổng</span>
                      <strong id="totalDays">0</strong>
                    </div>
                  </div>

                  <div class="mt-3">
                    <button id="saveAttendance" class="btn btn-primary btn-sm">Lưu</button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right column: calendar -->
            <div class="col-lg-9">
              <div class="calendar mb-3">
                <div id="notifyContainer"></div>

                <div class="d-flex justify-content-between align-items-center mb-2">
                  <h5 id="calendarTitle" class="mb-0"></h5>
                  <div class="d-flex align-items-center">
                    <div class="legend mr-3 d-none d-md-block">
                      <span>
                        <small class="badge badge-success">&nbsp;</small>
                        Có mặt
                      </span>
                      <span class="ml-2">
                        <small class="badge badge-danger">&nbsp;</small>
                        Vắng
                      </span>
                    </div>
                    <div class="calendar-controls">
                      <button id="prevMonth" class="btn btn-light btn-sm">‹</button>
                      <button id="todayBtn" class="btn btn-light btn-sm">Hôm nay</button>
                      <button id="nextMonth" class="btn btn-light btn-sm">›</button>
                    </div>
                  </div>
                </div>

                <div class="table-responsive">
                  <table class="table table-bordered mb-0">
                    <thead>
                      <tr id="weekDaysRow" class="text-center text-muted"></tr>
                    </thead>
                    <tbody id="calendarBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="assets/js/jquery-3.5.1.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/jquery.slimscroll.min.js"></script>
    <script src="assets/js/select2.min.js"></script>
    <script src="assets/js/jquery.dataTables.min.js"></script>
    <script src="assets/js/dataTables.bootstrap4.min.js"></script>
    <script src="assets/js/app.js"></script>

    <script>
      // Simple attendance calendar script
      (function () {
        // week starts on Monday
        const weekDays = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
        const employeeSelect = $('#employeeSelect');
        let current = new Date(); // holds month/year being shown
        let attendance = {}; // structure: attendance[employeeId]['YYYY-MM'] = { 'YYYY-MM-DD': 'present' | 'absent' }

        function storageKey(empId) {
          return 'attendance_' + empId;
        }

        // EMPLOYEES template (IDs use employee code)
        const EMPLOYEES = [
          {
            id: 'CMC-0001',
            code: 'CMC-0001',
            name: 'Nguyễn Văn An',
            position: 'Thiết kế Web',
            department: 'Design',
            email: 'an.nguyen@cmcglobal.vn',
            phone: '0901234001',
            joiningDate: '2013-01-01',
          },
          {
            id: 'CMC-0002',
            code: 'CMC-0002',
            name: 'Trần Thị Bích',
            position: 'Front-end Developer',
            department: 'Engineering',
            email: 'bich.tran@cmcglobal.vn',
            phone: '0901234002',
            joiningDate: '2016-07-15',
          },
          {
            id: 'CMC-0003',
            code: 'CMC-0003',
            name: 'Lê Văn Cường',
            position: 'QA Engineer',
            department: 'Quality',
            email: 'cuong.le@cmcglobal.vn',
            phone: '0901234003',
            joiningDate: '2018-11-01',
          },
          {
            id: 'CMC-0004',
            code: 'CMC-0004',
            name: 'Phạm Thị Dung',
            position: 'HR Executive',
            department: 'HR',
            email: 'dung.pham@cmcglobal.vn',
            phone: '0901234004',
            joiningDate: '2015-04-20',
          },
          {
            id: 'CMC-0005',
            code: 'CMC-0005',
            name: 'Bùi Minh Hoàng',
            position: 'Backend Developer',
            department: 'Engineering',
            email: 'hoang.bui@cmcglobal.vn',
            phone: '0901234005',
            joiningDate: '2017-09-10',
          },
          {
            id: 'CMC-0006',
            code: 'CMC-0006',
            name: 'Ngô Thị Mai',
            position: 'Business Analyst',
            department: 'Business',
            email: 'mai.ngo@cmcglobal.vn',
            phone: '0901234006',
            joiningDate: '2019-02-12',
          },
          {
            id: 'CMC-0007',
            code: 'CMC-0007',
            name: 'Phan Văn Long',
            position: 'DevOps',
            department: 'Engineering',
            email: 'long.phan@cmcglobal.vn',
            phone: '0901234007',
            joiningDate: '2020-06-01',
          },
          {
            id: 'CMC-0008',
            code: 'CMC-0008',
            name: 'Đỗ Thị Hạnh',
            position: 'QA Lead',
            department: 'Quality',
            email: 'hanh.do@cmcglobal.vn',
            phone: '0901234008',
            joiningDate: '2014-10-05',
          },
          {
            id: 'CMC-0009',
            code: 'CMC-0009',
            name: 'Lưu Văn Hải',
            position: 'Product Manager',
            department: 'Product',
            email: 'hai.luu@cmcglobal.vn',
            phone: '0901234009',
            joiningDate: '2012-03-20',
          },
          {
            id: 'CMC-0010',
            code: 'CMC-0010',
            name: 'Trịnh Thị Lan',
            position: 'HR Manager',
            department: 'HR',
            email: 'lan.trinh@cmcglobal.vn',
            phone: '0901234010',
            joiningDate: '2011-08-30',
          },
        ];

        // populate employee select from EMPLOYEES template
        function populateEmployeeSelect() {
          const $sel = $('#employeeSelect');
          $sel.empty();
          EMPLOYEES.forEach((emp) => {
            const opt = $('<option>').val(emp.id).text(`${emp.code} - ${emp.name}`);
            $sel.append(opt);
          });
        }

        // SAMPLE_ATTENDANCE keyed by employee code (CMC-...)
        const SAMPLE_ATTENDANCE = {
          'CMC-0001': {
            '2025-09': {
              '2025-09-01': 'present',
              '2025-09-02': 'absent',
              '2025-09-03': 'present',
              '2025-09-04': 'present',
              '2025-09-05': 'absent',
              '2025-09-08': 'present',
              '2025-09-09': 'present',
              '2025-09-10': 'present',
              '2025-09-11': 'present',
              '2025-09-12': 'present',
              '2025-09-13': 'present',
            },
            '2025-08': {
              '2025-08-01': 'present',
              '2025-08-02': 'present',
              '2025-08-03': 'absent',
              '2025-08-15': 'present',
            },
            '2025-07': {
              '2025-07-02': 'present',
              '2025-07-03': 'absent',
            },
          },
          'CMC-0002': {
            '2025-09': {
              '2025-09-01': 'present',
              '2025-09-02': 'present',
              '2025-09-03': 'present',
              '2025-09-04': 'present',
              '2025-09-05': 'present',
            },
            '2025-08': { '2025-08-04': 'present', '2025-08-05': 'absent' },
          },
          'CMC-0003': {
            '2025-09': { '2025-09-01': 'absent', '2025-09-02': 'absent', '2025-09-03': 'present', '2025-09-04': 'present' },
            '2025-06': { '2025-06-10': 'present', '2025-06-11': 'present' },
          },
          'CMC-0004': {
            '2025-09': { '2025-09-01': 'present', '2025-09-02': 'present' },
            '2025-08': { '2025-08-12': 'present' },
          },
          'CMC-0005': {
            '2025-09': { '2025-09-01': 'present', '2025-09-05': 'absent' },
            '2025-07': { '2025-07-20': 'present' },
          },
          'CMC-0006': { '2025-08': { '2025-08-01': 'present', '2025-08-02': 'present' } },
          'CMC-0007': { '2025-09': { '2025-09-03': 'present' } },
          'CMC-0008': { '2025-07': { '2025-07-07': 'absent' } },
          'CMC-0009': { '2025-06': { '2025-06-02': 'present' } },
          'CMC-0010': { '2025-05': { '2025-05-15': 'present' } },
        };

        function seedSampleAttendance() {
          try {
            // ensure select is populated first
            populateEmployeeSelect();
            Object.keys(SAMPLE_ATTENDANCE).forEach((empId) => {
              const key = storageKey(empId);
              if (!localStorage.getItem(key)) {
                localStorage.setItem(key, JSON.stringify(SAMPLE_ATTENDANCE[empId]));
              }
            });
          } catch (e) {
            console.warn('Seed attendance failed', e);
          }
        }

        function loadForEmployee(empId) {
          const raw = localStorage.getItem(storageKey(empId));
          attendance = raw ? JSON.parse(raw) : {};
        }

        function saveForEmployee(empId) {
          localStorage.setItem(storageKey(empId), JSON.stringify(attendance));
        }

        // lock current day for employee (prevents further edits of that date only)
        function lockCurrentDay() {
          const monthKey = getMonthKey(current);
          const todayKey = getDateKey(new Date());
          attendance[monthKey] = attendance[monthKey] || {};
          attendance[monthKey]._lockedDays = attendance[monthKey]._lockedDays || {};
          attendance[monthKey]._lockedDays[todayKey] = true;
        }

        function getMonthKey(d) {
          return d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0');
        }

        function getDateKey(d) {
          return d.getFullYear() + '-' + String(d.getMonth() + 1).padStart(2, '0') + '-' + String(d.getDate()).padStart(2, '0');
        }

        // notification helper (replaces alert)
        function showNotification(message, type = 'success', timeout = 3500) {
          // type: success / danger / info / warning
          const valid = ['success', 'danger', 'info', 'warning'];
          if (valid.indexOf(type) === -1) type = 'info';
          const $container = $('#notifyContainer');
          const id = 'notify_' + Date.now();
          const $el = $('<div>')
            .addClass('alert alert-' + type)
            .attr('id', id)
            .text(message);
          $container.prepend($el);
          if (timeout > 0) {
            setTimeout(() => {
              $el.fadeOut(300, function () {
                $el.remove();
              });
            }, timeout);
          }
        }

        function renderCalendar() {
          const year = current.getFullYear();
          const month = current.getMonth();
          const firstDay = new Date(year, month, 1);
          const lastDay = new Date(year, month + 1, 0);
          // shift so Monday=0, Sunday=6
          const startDayOfWeek = (firstDay.getDay() + 6) % 7;
          const totalDays = lastDay.getDate();

          $('#calendarTitle').text(firstDay.toLocaleString('default', { month: 'long', year: 'numeric' }));
          $('#monthLabel').text(firstDay.toLocaleString('default', { month: 'long', year: 'numeric' }));

          // header weekdays
          $('#weekDaysRow').empty();
          weekDays.forEach((d) => $('#weekDaysRow').append('<th class="text-center">' + d + '</th>'));

          const empId = employeeSelect.val();
          const monthKey = getMonthKey(current);
          const monthData = attendance[monthKey] && typeof attendance[monthKey] === 'object' ? attendance[monthKey] : {};

          const monthLocked = !!monthData._locked;

          // build calendar rows
          const rows = [];
          let cells = [];
          // blanks before first day
          for (let i = 0; i < startDayOfWeek; i++) {
            cells.push('<td class="other-month"></td>');
          }
          for (let d = 1; d <= totalDays; d++) {
            const dateObj = new Date(year, month, d);
            const dateKey = getDateKey(dateObj);
            const status = monthData[dateKey]; // 'present'|'absent'|undefined
            const dayLocked = !!(monthData._lockedDays && monthData._lockedDays[dateKey]);
            const todayKey = getDateKey(new Date());
            const disabledClass = dateKey !== todayKey ? ' disabled' : '';
            let classes = 'day text-center';
            if (status === 'present') classes += ' present';
            if (status === 'absent') classes += ' absent';
            if (dayLocked) classes += ' locked';
            classes += disabledClass;
            // only show day number
            const cell = `<td class="${classes}" data-date="${dateKey}" data-day="${d}">
                            <span class="date-num">${d}</span>
                          </td>`;
            cells.push(cell);
            if (cells.length % 7 === 0) {
              rows.push('<tr>' + cells.join('') + '</tr>');
              cells = [];
            }
          }
          // fill remaining cells to complete last week
          if (cells.length) {
            while (cells.length < 7) cells.push('<td class="other-month"></td>');
            rows.push('<tr>' + cells.join('') + '</tr>');
          }

          $('#calendarBody').html(rows.join(''));

          // stats
          updateStats();

          // attach click handler for toggling attendance
          $('#calendarBody .day')
            .off('click')
            .on('click', function () {
              const $td = $(this);
              // do not allow toggling for disabled days, other-month cells or locked days
              if ($td.hasClass('disabled') || $td.hasClass('other-month') || $td.hasClass('locked')) return;
              const dateKey = $td.data('date');
              if (!$td.data('date')) return;
              // ensure we only toggle days in current month (not other-month)
              const monthKey = getMonthKey(current);
              attendance[monthKey] = attendance[monthKey] || {};
              // Cycle: none -> present -> absent -> none
              const cur = attendance[monthKey][dateKey];
              if (!cur) attendance[monthKey][dateKey] = 'present';
              else if (cur === 'present') attendance[monthKey][dateKey] = 'absent';
              else delete attendance[monthKey][dateKey];

              renderCalendar();
            });
        }

        function updateStats() {
          const monthKey = getMonthKey(current);
          const monthData = attendance[monthKey] || {};
          let present = 0,
            absent = 0;
          for (const k in monthData) {
            if (monthData[k] === 'present') present++;
            if (monthData[k] === 'absent') absent++;
          }
          const total = new Date(current.getFullYear(), current.getMonth() + 1, 0).getDate();
          $('#presentCount').text(present);
          $('#absentCount').text(absent);
          $('#totalDays').text(total);
        }

        // controls
        $('#prevMonth').on('click', function () {
          current.setMonth(current.getMonth() - 1);
          renderCalendar();
        });
        $('#nextMonth').on('click', function () {
          current.setMonth(current.getMonth() + 1);
          renderCalendar();
        });
        $('#todayBtn').on('click', function () {
          current = new Date();
          renderCalendar();
        });

        $('#employeeSelect').on('change', function () {
          const empId = $(this).val();
          loadForEmployee(empId);
          // reset calendar to current month
          current = new Date();
          renderCalendar();
        });

        $('#saveAttendance').on('click', function () {
          const empId = employeeSelect.val();
          if (!empId) {
            showNotification('Chọn nhân viên trước.', 'danger');
            return;
          }
          // lock current day after saving so that date becomes not editable
          lockCurrentDay();
          saveForEmployee(empId);
          showNotification('Đã lưu chấm công cho ' + empId + ' (khóa ngày hôm nay).', 'success');
        });

        // clear removed per request (no delete button)

        // initialize
        $(document).ready(function () {
          // seed demo data into localStorage if not present and build select from template
          seedSampleAttendance();
          // initialize select2 if available
          if ($.fn.select2) $('#employeeSelect.select').select2({ width: '100%' });
          // populate select (seedSampleAttendance already calls populateEmployeeSelect)
          const empId = $('#employeeSelect').val();
          loadForEmployee(empId);
          renderCalendar();
        });
      })();
    </script>
  </body>
</html>
